# Docker Build Matrix Configuration
# 複数のCUDA/Python/ターゲットの組み合わせでビルドを実行するための設定

matrix:
  # CUDA 12.x系 + Python 3.13
  - cuda_version: "12.8.1"
    python_version: "3.13"
    cuda_tag: "cu128"
    targets:
      - name: "devel"
        tag: "simple-devel-cu128-py313-torch2.8.0"
      - name: "runtime"
        tag: "simple-runtime-cu128-py313-torch2.8.0"
      - name: "ray-devel"
        tag: "ray-devel-cu128-py313-torch2.8.0"
      - name: "ray-runtime"
        tag: "ray-runtime-cu128-py313-torch2.8.0"
      - name: "marimo-devel"
        tag: "marimo-devel-cu128-py313-torch2.8.0"
      - name: "marimo-runtime"
        tag: "marimo-runtime-cu128-py313-torch2.8.0"
  
  # CUDA 13.x系 + Python 3.14
  - cuda_version: "13.1.1"
    python_version: "3.14"
    cuda_tag: "cu130"
    targets:
      - name: "devel"
        tag: "simple-devel-cu130-py314-torch2.9.0"
      - name: "runtime"
        tag: "simple-runtime-cu130-py314-torch2.9.0"
      - name: "ray-devel"
        tag: "ray-devel-cu130-py314-torch2.9.0"
      - name: "ray-runtime"
        tag: "ray-runtime-cu130-py314-torch2.9.0"
      - name: "marimo-devel"
        tag: "marimo-devel-cu130-py314-torch2.9.0"
      - name: "marimo-runtime"
        tag: "marimo-runtime-cu130-py314-torch2.9.0"
  
  # CUDA 12.x系 + Python 3.14
  - cuda_version: "12.8.1"
    python_version: "3.14"
    cuda_tag: "cu128"
    targets:
      - name: "devel"
        tag: "simple-devel-cu128-py314-torch2.8.0"
      - name: "runtime"
        tag: "simple-runtime-cu128-py314-torch2.8.0"
      - name: "ray-devel"
        tag: "ray-devel-cu128-py314-torch2.8.0"
      - name: "ray-runtime"
        tag: "ray-runtime-cu128-py314-torch2.8.0"
      - name: "marimo-devel"
        tag: "marimo-devel-cu128-py314-torch2.8.0"
      - name: "marimo-runtime"
        tag: "marimo-runtime-cu128-py314-torch2.8.0"

# ビルド設定
build_options:
  platform: "linux/amd64"
  image_prefix: "plumiiume/cslr-exp-platform"
  
# 最小構成（テスト用）
minimal_build:
  cuda_version: "12.8.1"
  python_version: "3.13"
  cuda_tag: "cu128"
  target: "marimo-runtime"
  tag: "marimo-runtime-cu128-py313-torch2.8.0"
